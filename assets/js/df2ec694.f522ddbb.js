(self.webpackChunkexperimenter_docs=self.webpackChunkexperimenter_docs||[]).push([[5997],{3905:function(e,t,n){"use strict";n.d(t,{Zo:function(){return c},kt:function(){return u}});var i=n(7294);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,i,a=function(e,t){if(null==e)return{};var n,i,a={},r=Object.keys(e);for(i=0;i<r.length;i++)n=r[i],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(i=0;i<r.length;i++)n=r[i],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var s=i.createContext({}),p=function(e){var t=i.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},c=function(e){var t=p(e.components);return i.createElement(s.Provider,{value:t},e.children)},m={inlineCode:"code",wrapper:function(e){var t=e.children;return i.createElement(i.Fragment,{},t)}},d=i.forwardRef((function(e,t){var n=e.components,a=e.mdxType,r=e.originalType,s=e.parentName,c=l(e,["components","mdxType","originalType","parentName"]),d=p(n),u=a,h=d["".concat(s,".").concat(u)]||d[u]||m[u]||r;return n?i.createElement(h,o(o({ref:t},c),{},{components:n})):i.createElement(h,o({ref:t},c))}));function u(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var r=n.length,o=new Array(r);o[0]=d;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l.mdxType="string"==typeof e?e:a,o[1]=l;for(var p=2;p<r;p++)o[p]=n[p];return i.createElement.apply(null,o)}return i.createElement.apply(null,n)}d.displayName="MDXCreateElement"},6905:function(e,t,n){"use strict";n.r(t),n.d(t,{frontMatter:function(){return o},contentTitle:function(){return l},metadata:function(){return s},toc:function(){return p},default:function(){return m}});var i=n(2122),a=n(9756),r=(n(7294),n(3905)),o={id:"nimbus-cli-working-with-files",title:"Working with Files",slug:"/nimbus-cli/working-with-files"},l=void 0,s={unversionedId:"deep-dives/mobile/nimbus-cli/nimbus-cli-working-with-files",id:"deep-dives/mobile/nimbus-cli/nimbus-cli-working-with-files",isDocsHomePage:!1,title:"Working with Files",description:"fetch",source:"@site/docs/deep-dives/mobile/nimbus-cli/50-working-with-files.mdx",sourceDirName:"deep-dives/mobile/nimbus-cli",slug:"/nimbus-cli/working-with-files",permalink:"/nimbus-cli/working-with-files",editUrl:"https://github.com/mozilla/experimenter-docs/edit/main/docs/deep-dives/mobile/nimbus-cli/50-working-with-files.mdx",tags:[],version:"current",sidebarPosition:50,frontMatter:{id:"nimbus-cli-working-with-files",title:"Working with Files",slug:"/nimbus-cli/working-with-files"},sidebar:"sidebar",previous:{title:"Working with Features",permalink:"/nimbus-cli/working-with-features"},next:{title:"Working with Logs",permalink:"/nimbus-cli/working-with-logs"}},p=[{value:"<code>fetch</code>",id:"fetch",children:[]},{value:"<code>fetch-list</code>",id:"fetch-list",children:[]},{value:"<code>list</code>",id:"list",children:[]},{value:"<code>enroll</code>",id:"enroll",children:[]},{value:"<code>apply-file</code>",id:"apply-file",children:[]}],c={toc:p};function m(e){var t=e.components,n=(0,a.Z)(e,["components"]);return(0,r.kt)("wrapper",(0,i.Z)({},c,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h2",{id:"fetch"},(0,r.kt)("inlineCode",{parentName:"h2"},"fetch")),(0,r.kt)("p",null,"You can fetch a set of one or experiment/rollout recipes:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-sh"},"nimbus-cli --app fenix --channel developer fetch --output archived.json android-notification-surface-validation\n")),(0,r.kt)("p",null,"You can use ",(0,r.kt)("inlineCode",{parentName:"p"},"stage"),"/",(0,r.kt)("inlineCode",{parentName:"p"},"production")," to specify a Nimbus API instance."),(0,r.kt)("p",null,"This command fetches the ",(0,r.kt)("inlineCode",{parentName:"p"},"android-research-surface-validation")," experiment from production and ",(0,r.kt)("inlineCode",{parentName:"p"},"crolloutmobile")," from stage, and puts it in ",(0,r.kt)("inlineCode",{parentName:"p"},"archived.json"),"."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-sh"},"nimbus-cli --app fenix --channel developer fetch --output archived.json android-research-surface-validation stage/crolloutmobile\n")),(0,r.kt)("p",null,"This might be useful for attaching to bug reports."),(0,r.kt)("div",{className:"admonition admonition-tip alert alert--success"},(0,r.kt)("div",{parentName:"div",className:"admonition-heading"},(0,r.kt)("h5",{parentName:"div"},(0,r.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,r.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,r.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"}))),"tip")),(0,r.kt)("div",{parentName:"div",className:"admonition-content"},(0,r.kt)("p",{parentName:"div"},"If ",(0,r.kt)("inlineCode",{parentName:"p"},"--output")," is missing, the file is printed to the console."),(0,r.kt)("p",{parentName:"div"},"You can get a view of the experiment JSON from an experimenter URL like this:"),(0,r.kt)("pre",{parentName:"div"},(0,r.kt)("code",{parentName:"pre",className:"language-sh"},"nimbus-cli --app fenix --channel developer fetch https://experimenter.services.mozilla.com/nimbus/release-android-onboarding-redesign\n")),(0,r.kt)("p",{parentName:"div"},"This may be helpful when ",(0,r.kt)("inlineCode",{parentName:"p"},"info")," isn't enough."),(0,r.kt)("pre",{parentName:"div"},(0,r.kt)("code",{parentName:"pre",className:"language-sh"},"nimbus-cli --app fenix --channel developer info https://experimenter.services.mozilla.com/nimbus/release-android-onboarding-redesign\n")))),(0,r.kt)("h2",{id:"fetch-list"},(0,r.kt)("inlineCode",{parentName:"h2"},"fetch-list")),(0,r.kt)("p",null,"Alternatively, you fetch the entire contents of a server's experiments:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-sh"},"nimbus-cli --app fenix --channel developer \\\n    fetch-list \\\n    --output archived.json\n")),(0,r.kt)("p",null,"By default, this uses Remote Settings: you can see the contents of that the apps are currently seeing."),(0,r.kt)("p",null,"This is quick\u2014 it shows only live experiments, but changes in the experiments in Experimenter aren't reflected in Remote Settings for approximately an hour."),(0,r.kt)("p",null,"You can get all experiments from the API\u2014 both live and completed\u2014 using the ",(0,r.kt)("inlineCode",{parentName:"p"},"--use-api")," flag."),(0,r.kt)("h2",{id:"list"},(0,r.kt)("inlineCode",{parentName:"h2"},"list")),(0,r.kt)("p",null,"The ",(0,r.kt)("inlineCode",{parentName:"p"},"list")," command takes a ",(0,r.kt)("inlineCode",{parentName:"p"},"--file")," parameter to make working with these files a little easier:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-sh"},"nimbus-cli --app fenix --channel developer list --file archived.json\n")),(0,r.kt)("div",{className:"admonition admonition-tip alert alert--success"},(0,r.kt)("div",{parentName:"div",className:"admonition-heading"},(0,r.kt)("h5",{parentName:"div"},(0,r.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,r.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,r.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"}))),"tip")),(0,r.kt)("div",{parentName:"div",className:"admonition-content"},(0,r.kt)("p",{parentName:"div"},"Anywhere you specify an experiment, you can load it from a file with ",(0,r.kt)("inlineCode",{parentName:"p"},"--file"),"."),(0,r.kt)("p",{parentName:"div"},"For example: you may want ",(0,r.kt)("inlineCode",{parentName:"p"},"fetch-list")," from a Remote Settings"),(0,r.kt)("pre",{parentName:"div"},(0,r.kt)("code",{parentName:"pre",className:"language-sh"},"nimbus-cli --app fenix --channel developer fetch-list --output list-for-bugreport.json\n")),(0,r.kt)("p",{parentName:"div"},"Later, you may investigate the file, and find that two experiments in particular are causing problems."),(0,r.kt)("pre",{parentName:"div"},(0,r.kt)("code",{parentName:"pre",className:"language-sh"},"nimbus-cli --app fenix --channel developer list --file list-for-bugreport.json\n")),(0,r.kt)("p",{parentName:"div"},"You can isolate those experiments in a different file using the ",(0,r.kt)("inlineCode",{parentName:"p"},"fetch")," command with an input ",(0,r.kt)("inlineCode",{parentName:"p"},"--file")," and an output ",(0,r.kt)("inlineCode",{parentName:"p"},"--output")," file parameters."),(0,r.kt)("pre",{parentName:"div"},(0,r.kt)("code",{parentName:"pre",className:"language-sh"},"nimbus-cli --app fenix --channel developer \\\n    fetch \\\n    mobile-default-browser-cta-copy-test fx-release-android-re-engagement-notifications-114-rollout \\\n    --file list-for-bugreport.json \\\n    --output isolated-list.json\n")))),(0,r.kt)("h2",{id:"enroll"},(0,r.kt)("inlineCode",{parentName:"h2"},"enroll")),(0,r.kt)("p",null,"The ",(0,r.kt)("inlineCode",{parentName:"p"},"enroll")," command takes ",(0,r.kt)("inlineCode",{parentName:"p"},"--file")," parameter, so you can enroll from recipes stored locally:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-sh"},"nimbus-cli --app fenix --channel developer \\\n    --file archived.json \\\n    enroll android-research-surface-validation --branch treatment\n")),(0,r.kt)("h2",{id:"apply-file"},(0,r.kt)("inlineCode",{parentName:"h2"},"apply-file")),(0,r.kt)("p",null,"You can also upload the whole file straight to the SDK:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-sh"},"nimbus-cli --app fenix --channel developer \\\n    apply-file archived.json\n")),(0,r.kt)("div",{className:"admonition admonition-info alert alert--info"},(0,r.kt)("div",{parentName:"div",className:"admonition-heading"},(0,r.kt)("h5",{parentName:"div"},(0,r.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,r.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,r.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"}))),"info")),(0,r.kt)("div",{parentName:"div",className:"admonition-content"},(0,r.kt)("p",{parentName:"div"},"Many ",(0,r.kt)("inlineCode",{parentName:"p"},"nimbus-cli")," commands reads (",(0,r.kt)("inlineCode",{parentName:"p"},"--file"),") and writes (",(0,r.kt)("inlineCode",{parentName:"p"},"--output"),") to JSON files. For all these commands, If the file extension is ",(0,r.kt)("inlineCode",{parentName:"p"},"yaml")," or ",(0,r.kt)("inlineCode",{parentName:"p"},"yml"),", then it will treat it as YAML."))))}m.isMDXComponent=!0}}]);